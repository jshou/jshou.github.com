<html>
<head>

<meta name="viewport" content="width=device-width">

<!-- Compiled and minified CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<link href='https://fonts.googleapis.com/css?family=Ubuntu:400,400i' rel='stylesheet' type='text/css'>

<!-- Compiled and minified JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
<script src="scripts/mustache.min.js"></script>
<script src="scripts/google-calendar-events.min.js"></script>
<script src="scripts/moment.min.js"></script>

<style>
html {
  font-family: Ubuntu;
}

#gigs li {
  margin-bottom: 20px;
}

#gigs .date {
  font-style: oblique;
}

section {
  max-width: 600px;
}
</style>
</head>

<body>
<div class="container">
  <h2>Joshua Hou</h2>

  <section id="bio">
    <h4>Bio</h4>
    <p>Joshua Hou is a jazz pianist/accordionist based in Seattle, Washington. He
    can be found singing and playing music in a variety of venues in the greater
    Seattle area.</p>

    <p>He can be contacted at <a href="mailto:me@joshuahou.com">me@joshuahou.com</a></p>
  </section>


  <section id="projects">
    <h4>Projects</h4>
    <ul>
      <li><a href="http://howshortjazz.com">How Short</a></li>
      <li>Trumpet, Accordion, Bass Jazz trio</li>
    </ul>
  </section>

  <section id="gigs">
    <h4>Gigs</h4>
    <ul>
    </ul>
  </section>

  <script id="gig" type="x-tmpl-mustache">
    <li>
      <div class="date">{{ date }}, {{ start }} - {{ end }}</div>
      <div class="event">{{ band }} (<a href="{{ venueMap }}">map</a>)</div>
    </li>
  </script>

  <script>
    var mykey = 'AIzaSyCA9pV8ZJNnG2Gmerj71DF30noN8DTiQ9c';
    var calendarid = 'nr5jftdjm9p0lg4pigi0dsld6c@group.calendar.google.com';

    var schedule = $.grabCalendar({
      type: "detailedEvents",
      clean_date: false,
      maxEvents: 20,
      upcoming: true,
    });

    var template = $('#gig').html();
    Mustache.parse(template);

    for (var i = 0; i < schedule.length; i++) {
      var date =  moment(schedule[i].start.dateTime).format('dddd, MMM Do YYYY');
      var start = moment(schedule[i].start.dateTime).format('h:mmA');
      var end = moment(schedule[i].end.dateTime).format('h:mmA');
      var band = schedule[i].summary;
      var venue = schedule[i].location;
      var venueMap = "https://www.google.com/maps/search/?api=1&query=" + encodeURIComponent(venue);

      var rendered = Mustache.render(template, {date: date, start: start, end: end, band: band, venueMap: venueMap});
      $('#gigs ul').append(rendered);
      console.log(band);
    }
  </script>
</div>
</body>
</html>
